<!DOCTYPE html>
<!--####################################################################
	THIS IS A GENERATED FILE â€” ANY CHANGES MADE WILL BE OVERWRITTEN

	INSTEAD CHANGE:
	source: src/angular/11-writing-unit-tests/writing-unit-tests.md
	@page angular/writing-unit-tests
######################################################################## -->
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Bitovi University - Writing Unit Tests</title>
  
  <link rel="stylesheet" type="text/css" href="../static/bundles/bit-docs-site/static.css">
  
</head>

<body>
  <header>
    <img src="../static/img/logo.svg" alt="Bitovi" class="logo" width="100">
    
  </header>
  <div class="content">
	
		<nav class="sidebar">
	
		
			<ul>
				<li class="">
					<a class="home" href="../index.html" title="Home">
						Home
					</a>
				</li>
			</ul>
		
		
	<ul>
		
			
		
			
				
					<li class="
           						
           						">
						<a class="page"
							href="../advanced-javascript-training.html"
							title="This course covers all the hard but important stuff you should know when learning JavaScript.">
							Advanced JavaScript
						</a>
						
					</li>
				
			
		
			
				
					<li class="
           						
           						">
						<a class="page"
							href="../dom-jquery-training.html"
							title="Learn jQuery and the DOM APIs by building your own version of jQuery and using it to make a basic tabs widget.">
							DOM and jQuery
						</a>
						
					</li>
				
			
		
			
				
					<li class="
           						
           						">
						<a class="page"
							href="../debugging-javascript-training.html"
							title="This course covers the basics of JavaScript debugging.">
							Debug JavaScript
						</a>
						
					</li>
				
			
		
			
				
					<li class="
           						
           						">
						<a class="page"
							href="../typescript.html"
							title="This course covers the basic essentials of TypeScript. At the end, you should be ready to develop projects in TypeScript.">
							TypeScript
						</a>
						
					</li>
				
			
		
			
		
			
		
			
				
					<li class="
           						
           						">
						<a class="page"
							href="../RxJS.html"
							title="Learn RxJS by creating a validating credit card form.">
							RxJS
						</a>
						
					</li>
				
			
		
			
				
					<li class="
           						parent
           						expanded">
						<a class="page"
							href="../angular.html"
							title="Learn the basics of Angular.">
							Angular
						</a>
						
							
	<ul>
		
			
				
					<li class="
           						
           						">
						<a class="page"
							href="why-angular.html"
							title="Why Angular is a great choice for modern web application development.">
							Why Angular
						</a>
						
					</li>
				
			
		
			
				
					<li class="
           						
           						">
						<a class="page"
							href="building-our-first-app.html"
							title="Building Our First App">
							Building Our First App
						</a>
						
					</li>
				
			
		
			
				
					<li class="
           						
           						">
						<a class="page"
							href="creating-components.html"
							title="Creating Our First Components">
							Creating Components
						</a>
						
					</li>
				
			
		
			
				
					<li class="
           						
           						">
						<a class="page"
							href="adding-routing.html"
							title="Adding Routing">
							Adding Routing
						</a>
						
					</li>
				
			
		
			
				
					<li class="
           						
           						">
						<a class="page"
							href="creating-navigation.html"
							title="Creating Navigation">
							Creating Navigation
						</a>
						
					</li>
				
			
		
			
				
					<li class="
           						
           						">
						<a class="page"
							href="restaurant-service.html"
							title="Writing a Restaurant Service">
							Writing a Restaurant Service
						</a>
						
					</li>
				
			
		
			
				
					<li class="
           						
           						">
						<a class="page"
							href="pull-restaurant-data-into-view.html"
							title="Pulling Restaurant Data into Our View">
							Use Restaurant API data
						</a>
						
					</li>
				
			
		
			
				
					<li class="
           						
           						">
						<a class="page"
							href="state-city-options.html"
							title="Creating city &amp; state options for filtering restaurants">
							City &amp; State Options
						</a>
						
					</li>
				
			
		
			
				
					<li class="
           						
           						">
						<a class="page"
							href="form-value-changes.html"
							title="Listening to Form Value Changes">
							Listening to Form Value Changes
						</a>
						
					</li>
				
			
		
			
				
					<li class="
           						
           						">
						<a class="page"
							href="updating-service-params.html"
							title="Updating Restaurant Service to use params">
							Filtering Cities &amp; Restaurants
						</a>
						
					</li>
				
			
		
			
				
					<li class="current
           						parent
           						expanded">
						<a class="page"
							href="writing-unit-tests.html"
							title="Write a service unit test">
							Writing Unit Tests
						</a>
						
							

						
					</li>
				
			
		
			
				
					<li class="
           						
           						">
						<a class="page"
							href="nested-routes.html"
							title="Creating nested restaurant routes">
							Nested Restaurant Routes
						</a>
						
					</li>
				
			
		
			
				
					<li class="
           						
           						">
						<a class="page"
							href="building-order-form.html"
							title="Building the Order Form">
							Building the Order Form
						</a>
						
					</li>
				
			
		
			
				
					<li class="
           						
           						">
						<a class="page"
							href="order-service.html"
							title="Writing the Order Service">
							Order Service
						</a>
						
					</li>
				
			
		
			
				
					<li class="
           						
           						">
						<a class="page"
							href="order-history-component.html"
							title="Writing the Order History Component">
							Order History Component
						</a>
						
					</li>
				
			
		
			
				
					<li class="
           						
           						">
						<a class="page"
							href="real-time-connection.html"
							title="Updating Order History View with Real Time Connection">
							Real Time Connections
						</a>
						
					</li>
				
			
		
			
				
					<li class="
           						
           						">
						<a class="page"
							href="deploy-app.html"
							title="Deploying App">
							Deploy App
						</a>
						
					</li>
				
			
		
	</ul>


						
					</li>
				
			
		
			
				
					<li class="
           						
           						">
						<a class="page"
							href="../training.html"
							title="Learn how to prepare and give a training.">
							Giving a Training
						</a>
						
					</li>
				
			
		
	</ul>


	
</nav>

	
	<article class="main">
		
			<section class="title">
	<h1>Writing Unit Tests <code>page</code></h1>
</section>

		

		
			
				<section class="description">
    <p>Write a service unit test</p>

</section>

			
		

		
			
				
			
			
				<section class="body">
    <h2>Overview</h2>
<p>In this part, we will:</p>
<ul>
<li>Get our existing tests to pass</li>
<li>Run our tests</li>
<li>Write a test to get cities and states</li>
</ul>
<h2>Get our unit tests to work again</h2>
<p>Update the following three files:</p>
<p>1. <strong>src/app/app.component.spec.ts</strong></p>
<pre><code class="language-ts">import { TestBed, async } from '@angular/core/testing';
import { RouterTestingModule } from '@angular/router/testing';
import { AppComponent } from './app.component';

describe('AppComponent', () =&gt; {
  beforeEach(async(() =&gt; {
    TestBed.configureTestingModule({
      imports: [
        RouterTestingModule
      ],
      declarations: [
        AppComponent
      ],
    }).compileComponents();
  }));

  it('should create the app', () =&gt; {
    const fixture = TestBed.createComponent(AppComponent);
    const app = fixture.debugElement.componentInstance;
    expect(app).toBeTruthy();
  });

  it(`should have as title 'place-my-order'`, () =&gt; {
    const fixture = TestBed.createComponent(AppComponent);
    const app = fixture.debugElement.componentInstance;
    expect(app.title).toEqual('place-my-order');
  });

  it('should render title in a h1 tag', () =&gt; {
    const fixture = TestBed.createComponent(AppComponent);
    fixture.detectChanges();
    const compiled = fixture.debugElement.nativeElement;
    expect(compiled.querySelector('h1').textContent).toContain('place-my-order.com');
  });
});

</code></pre>
<div line-highlight='18-19,31-33'></div>
<ol start="2">
<li><strong>src/app/image-url.pipe.spec.ts</strong></li>
</ol>
<pre><code class="language-ts">import { ImageUrlPipe } from './image-url.pipe';

describe('ImageUrlPipe', () =&gt; {
  it('create an instance', () =&gt; {
    const pipe = new ImageUrlPipe();
    expect(pipe).toBeTruthy();
  });

  it('returns a string with proper assets path', () =&gt; {
    const pipe = new ImageUrlPipe();
    expect(pipe.transform('node_modules/place-my-order-assets/tacos.png')).toBe('./assets/tacos.png');
  })
});
</code></pre>
<ol start="3">
<li><strong>src/app/restaurant.component.spec.ts</strong></li>
</ol>
<pre><code class="language-ts">import { async, ComponentFixture, TestBed } from '@angular/core/testing';

import { RestaurantComponent } from './restaurant.component';
import { RestaurantService } from './restaurant.service';
import { ReactiveFormsModule } from '@angular/forms';
import { ImageUrlPipe } from '../image-url.pipe';
import { RouterTestingModule } from '@angular/router/testing';
import { of } from 'rxjs';

describe('RestaurantComponent', () =&gt; {
  let component: RestaurantComponent;
  let fixture: ComponentFixture&lt;RestaurantComponent&gt;;

  let fakeRestaurants = [{
    name: 'Burger Shack',
    slug: 'burger-shack',
    images: {},
    menu: [{
      name: 'fries',
      price: 3.99
    }],
    address: {},
    _id: '12233asdas11'
  }];

  class restaurantServiceStub {
    getRestaurants() {
      return fakeRestaurants
    }
    getStates() {
      return of({
        data: [
          {name: 'Missouri', short: 'MO'}
        ]
      })
    }
    getCities() {
      return of({
        data: [
          {name: 'Kansas City', state: 'MO', }
        ]
      })
    }
  }

  beforeEach(async(() =&gt; {
    TestBed.configureTestingModule({
      declarations: [ RestaurantComponent, ImageUrlPipe ],
      imports: [ReactiveFormsModule, RouterTestingModule],
      providers: [
        {provide: RestaurantService, useClass: restaurantServiceStub } 
      ]
    })
    .compileComponents();
  }));

  beforeEach(() =&gt; {
    fixture = TestBed.createComponent(RestaurantComponent);
    component = fixture.componentInstance;
    fixture.detectChanges();
  });

  it('should create', () =&gt; {
    expect(component).toBeTruthy();
  });
});

</code></pre>
<div line-highlight='26,31,47-53'></div>
<h2>Run our tests</h2>
<p>Run the following in your terminal:</p>
<pre><code class="language-shell">ng test
</code></pre>
<h2>Exercise: Write restaurant service test</h2>
<p><strong>src/app/restaurant.service.spec.ts</strong></p>
<pre><code class="language-ts">import { TestBed } from '@angular/core/testing';

import { RestaurantService } from './restaurant.service';
import { HttpClientTestingModule, HttpTestingController } from '@angular/common/http/testing';

describe('RestaurantService', () =&gt; {
  let httpMock : HttpTestingController;
  let restaurantService: RestaurantService;

  beforeEach(() =&gt; TestBed.configureTestingModule({
    imports: [HttpClientTestingModule],
    providers: [
      RestaurantService
    ]
  }));

  beforeEach(() =&gt; {
    httpMock = TestBed.get(HttpTestingController);
    restaurantService = TestBed.get(RestaurantService);
  })

  it('should be created', () =&gt; {
    expect(restaurantService).toBeTruthy();
  });

  it('should make a get request to states', () =&gt; {
    const mockStates = {
      data: [
        {name: 'Missouri', short: 'MO'}
      ]
    };

    restaurantService.getStates().subscribe((states) =&gt; {
      expect(states).toEqual(mockStates);
    });

    let url = '/api/states';
    const req = httpMock.expectOne(url);

    expect(req.request.method).toEqual('GET');
    req.flush(mockStates);

    httpMock.verify();
  });

  it('should make a get request to cities', () =&gt; {
    const mockCities = {
      data: [
        {name: 'Kansas City', state: 'MO'}
      ]
    };

    restaurantService.getCities('MO').subscribe((cities) =&gt; {
      expect(cities).toEqual(mockCities);
    });

    let url = '/api/cities?state=MO';
    const req = httpMock.expectOne(url);
    expect(req.request.method).toEqual('GET');
    req.flush(mockCities);

    httpMock.verify();
  })


});

</code></pre>
<div line-highlight='7,10-15,18-19,38-41,43'></div>

</section>

			
		
	</article>
</div>

  <footer></footer>

  <script type="text/javascript">
    var docObject = {"src":{"path":"src/angular/11-writing-unit-tests/writing-unit-tests.md"},"description":"Write a service unit test \n","name":"angular/writing-unit-tests","title":"Writing Unit Tests","type":"page","parent":"angular","order":11,"comment":" ","pathToRoot":"../.."};
  </script>

  
    <script>
      steal = {
        instantiated: {
          "bundles/bit-docs-site/static.css!$css" : null
        }
      }
    </script>
    <script type='text/javascript'
        data-main="bit-docs-site/static"
        src="../static/steal.production.js"></script>
  

<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-2302003-29"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-2302003-29');
</script>

</body>
</html>

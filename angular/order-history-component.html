<!DOCTYPE html>
<!--####################################################################
	THIS IS A GENERATED FILE â€” ANY CHANGES MADE WILL BE OVERWRITTEN

	INSTEAD CHANGE:
	source: src/angular/15-order-history-component/order-history-component.md
	@page angular/order-history-component
######################################################################## -->
<html lang="en">
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Bitovi University - Order History Component</title>
	
	<link rel="stylesheet" type="text/css" href="../static/bundles/bit-docs-site/static.css">
	
</head>

<body>
	<header></header>
	<div class="content">
	
		<nav class="sidebar">
	
		
			<ul>
				<li class="">
					<a class="home" href="../index.html" title="Home">
						Home
					</a>
				</li>
			</ul>
		
		
	<ul>
		
			
		
			
				
					<li class="
           						
           						">
						<a class="page"
							href="../advanced-javascript-training.html"
							title="This course covers all the hard but important stuff you should know when learning JavaScript.">
							Advanced JavaScript
						</a>
						
					</li>
				
			
		
			
				
					<li class="
           						
           						">
						<a class="page"
							href="../dom-jquery-training.html"
							title="Learn jQuery and the DOM APIs by building your own version of jQuery and using it to make a basic tabs widget.">
							DOM and jQuery
						</a>
						
					</li>
				
			
		
			
				
					<li class="
           						
           						">
						<a class="page"
							href="../debugging-javascript-training.html"
							title="This course covers the basics of JavaScript debugging.">
							Debug JavaScript
						</a>
						
					</li>
				
			
		
			
				
					<li class="
           						
           						">
						<a class="page"
							href="../typescript.html"
							title="This course covers the basic essentials of TypeScript. At the end, you should be ready to develop projects in TypeScript.">
							TypeScript
						</a>
						
					</li>
				
			
		
			
				
					<li class="
           						
           						">
						<a class="page"
							href="../react.html"
							title="This guide introduces React, the things you should learn before approaching React, and some advanced React topics.">
							React
						</a>
						
					</li>
				
			
		
			
		
			
				
					<li class="
           						
           						">
						<a class="page"
							href="../RxJS.html"
							title="Learn RxJS by creating a validating credit card form.">
							RxJS
						</a>
						
					</li>
				
			
		
			
				
					<li class="
           						parent
           						expanded">
						<a class="page"
							href="../angular.html"
							title="Learn the basics of Angular.">
							Angular
						</a>
						
							
	<ul>
		
			
				
					<li class="
           						
           						">
						<a class="page"
							href="why-angular.html"
							title="Why Angular is a great choice for modern web application development.">
							Why Angular
						</a>
						
					</li>
				
			
		
			
				
					<li class="
           						
           						">
						<a class="page"
							href="building-our-first-app.html"
							title="Building Our First App">
							Building Our First App
						</a>
						
					</li>
				
			
		
			
				
					<li class="
           						
           						">
						<a class="page"
							href="creating-components.html"
							title="Creating Our First Components">
							Creating Components
						</a>
						
					</li>
				
			
		
			
				
					<li class="
           						
           						">
						<a class="page"
							href="adding-routing.html"
							title="Adding Routing">
							Adding Routing
						</a>
						
					</li>
				
			
		
			
				
					<li class="
           						
           						">
						<a class="page"
							href="creating-navigation.html"
							title="Creating Navigation">
							Creating Navigation
						</a>
						
					</li>
				
			
		
			
				
					<li class="
           						
           						">
						<a class="page"
							href="restaurant-service.html"
							title="Writing a Restaurant Service">
							Writing a Restaurant Service
						</a>
						
					</li>
				
			
		
			
				
					<li class="
           						
           						">
						<a class="page"
							href="pull-restaurant-data-into-view.html"
							title="Pulling Restaurant Data into Our View">
							Pulling restaurant data into our view
						</a>
						
					</li>
				
			
		
			
				
					<li class="
           						
           						">
						<a class="page"
							href="state-city-options.html"
							title="Creating city &amp; state options for filtering restaurants">
							City &amp; State Options
						</a>
						
					</li>
				
			
		
			
				
					<li class="
           						
           						">
						<a class="page"
							href="form-value-changes.html"
							title="Listening to Form Value Changes">
							Listening to Form Value Changes
						</a>
						
					</li>
				
			
		
			
				
					<li class="
           						
           						">
						<a class="page"
							href="updating-service-params.html"
							title="Updating Restaurant Service to use params">
							Filtering Cities &amp; Restaurants
						</a>
						
					</li>
				
			
		
			
				
					<li class="
           						
           						">
						<a class="page"
							href="nested-routes.html"
							title="Creating nested restaurant routes">
							Nested Restaurant Routes
						</a>
						
					</li>
				
			
		
			
				
					<li class="
           						
           						">
						<a class="page"
							href="building-order-form.html"
							title="Building the Order Form">
							Building the Order Form
						</a>
						
					</li>
				
			
		
			
				
					<li class="
           						
           						">
						<a class="page"
							href="order-service.html"
							title="Writing the Order Service">
							Order Service
						</a>
						
					</li>
				
			
		
			
				
					<li class="current
           						parent
           						expanded">
						<a class="page"
							href="order-history-component.html"
							title="Writing the Order History Component">
							Order History Component
						</a>
						
							

						
					</li>
				
			
		
			
				
					<li class="
           						
           						">
						<a class="page"
							href="real-time-connection.html"
							title="Updating Order History View with Real Time Connection">
							Real Time Connections
						</a>
						
					</li>
				
			
		
	</ul>


						
					</li>
				
			
		
			
				
					<li class="
           						
           						">
						<a class="page"
							href="../training.html"
							title="Learn how to prepare and give a training.">
							Giving a Training
						</a>
						
					</li>
				
			
		
	</ul>


	
</nav>

	
	<article class="main">
		
			<section class="title">
	<h1>Order History Component <code>page</code></h1>
</section>

		

		
			
				<section class="description">
    <p>Writing the Order History Component</p>

</section>

			
		

		
			
				
			
			
				<section class="body">
    <h2>Overview</h2>
<p>In this part, we will:</p>
<ul>
<li>Create a new order history component</li>
<li>Get all orders from our order service</li>
<li>Create a child component to handle different states of orders</li>
<li>Create ways to update and delete orders in the view</li>
<li>Add order history link to our main navigation</li>
</ul>
<h2>Creating Order History Component</h2>
<pre><code class="language-bash">ng g component order/history
</code></pre>
<p><strong>src/app/order/history.component.ts</strong></p>
<pre><code class="language-ts">import { Component, OnInit } from '@angular/core';
import { OrderService, Order } from '../order.service';
import { ResponseData } from '../../restaurant/restaurant.service';

interface Data&lt;T&gt; {
  value: Array&lt;T&gt;;
  isPending: boolean;
}

@Component({
  selector: 'pmo-history',
  templateUrl: './history.component.html',
  styleUrls: ['./history.component.less']
})
export class HistoryComponent implements OnInit {
  public orders: Data&lt;Order&gt; = {
    value: [],
    isPending: true
  }

  constructor(
    private orderService: OrderService
    ) {
    }

  ngOnInit() {
    this.getOrders();

  }

  getOrders() {
    this.orderService.getOrders().subscribe((res: ResponseData&lt;Order&gt;) =&gt; {
      this.orders.value = res.data;
    });
  }

  get newOrders() {
    let orders =  this.orders.value.filter((order) =&gt; {
      return order.status === &quot;new&quot;;
    });
    return orders;
  }

   get preparingOrders() {
    let orders =  this.orders.value.filter((order) =&gt; {
      return order.status === &quot;preparing&quot;;
    });
    return orders;
   }

   get deliveryOrders() {
    let orders =  this.orders.value.filter((order) =&gt; {
      return order.status === &quot;delivery&quot;;
    });
    return orders;
   }

   get deliveredOrders() {
    let orders =  this.orders.value.filter((order) =&gt; {
      return order.status === &quot;delivered&quot;;
    });
    return orders;
   }

}

</code></pre>
<div line-highlight='2, 22, 31-35'></div>
<p><strong>src/app/order/history.component.html</strong></p>
<pre><code class="language-html">&lt;div class=&quot;order-history&quot;&gt;
  &lt;div class=&quot;order header&quot;&gt;
    &lt;address&gt;Name / Address / Phone&lt;/address&gt;
    &lt;div class=&quot;items&quot;&gt;Order&lt;/div&gt;
    &lt;div class=&quot;total&quot;&gt;Total&lt;/div&gt;
    &lt;div class=&quot;actions&quot;&gt;Action&lt;/div&gt;
  &lt;/div&gt;

  &lt;pmo-order-list
    [orders]=&quot;newOrders&quot;
    listTitle=&quot;New Orders&quot;
    status=&quot;new&quot;
    statusTitle=&quot;New Order!&quot;
    action=&quot;preparing&quot;
    actionTitle=&quot;Preparing&quot;
    emptyMessage=&quot;No new orders&quot;&gt;
    &lt;/pmo-order-list&gt;

    &lt;pmo-order-list
    [orders]=&quot;preparingOrders&quot;
    listTitle=&quot;Preparing&quot;
    status=&quot;preparing&quot;
    statusTitle=&quot;Preparing&quot;
    action=&quot;delivery&quot;
    actionTitle=&quot;Out for delivery&quot;
    emptyMessage=&quot;No orders preparing&quot;&gt;
    &lt;/pmo-order-list&gt;

    &lt;pmo-order-list
    [orders]=&quot;deliveryOrders&quot;
    listTitle=&quot;Out for delivery&quot;
    status=&quot;delivery&quot;
    statusTitle=&quot;Out for delivery&quot;
    action=&quot;delivered&quot;
    actionTitle=&quot;Delivered&quot;
    emptyMessage=&quot;No orders are being delivered&quot;&gt;
    &lt;/pmo-order-list&gt;

    &lt;pmo-order-list
    [orders]=&quot;deliveredOrders&quot;
    listTitle=&quot;Delivery&quot;
    status=&quot;delivered&quot;
    statusTitle=&quot;Delivered&quot;
    emptyMessage=&quot;No delivered orders&quot;&gt;
    &lt;/pmo-order-list&gt;
&lt;/div&gt;
</code></pre>
<h2>Creating a Child Component to Handle Order States</h2>
<p>Orders can have states of new, preparing, delivery, and delivered, and we want to have different actions to take in the UI based on an orders status. This new component will take a variety of different data sources.</p>
<pre><code class="language-bash">ng g component order/list
</code></pre>
<p><strong>src/app/order/list.component.html</strong></p>
<pre><code class="language-html">&lt;h4&gt;{{listTitle}}&lt;/h4&gt;
&lt;div class=&quot;loading&quot; *ngIf=&quot;isPending&quot;&gt;&lt;/div&gt;
&lt;ng-container *ngFor=&quot;let order of orders&quot;&gt;
  &lt;div [ngClass]=&quot;['order', order.status? order.status: '']&quot;&gt;
    &lt;address&gt;
      {{order.name}} &lt;br /&gt;{{order.address}} &lt;br /&gt;{{order.phone}}
    &lt;/address&gt;
  
    &lt;div class=&quot;items&quot;&gt;
      &lt;ul&gt;
        &lt;li *ngFor=&quot;let item of order.items&quot;&gt;{{item.name}}&lt;/li&gt;
      &lt;/ul&gt;
    &lt;/div&gt;
  
    &lt;div class=&quot;total&quot;&gt;${{total(order.items)}}&lt;/div&gt;
  
    &lt;div class=&quot;actions&quot;&gt;
      &lt;span class=&quot;badge&quot;&gt;{{statusTitle}}&lt;/span&gt;
        &lt;p class=&quot;action&quot; *ngIf=&quot;action&quot;&gt;
          Mark as:
          &lt;a href=&quot;javascript://&quot; (click)=&quot;markAs(order, action)&quot;&gt;
            {{actionTitle}}
          &lt;/a&gt;
        &lt;/p&gt;
  
      &lt;p class=&quot;action&quot;&gt;
        &lt;a href=&quot;javascript://&quot;  (click)=&quot;delete(order._id)&quot;&gt;Delete&lt;/a&gt;
      &lt;/p&gt;
    &lt;/div&gt;
  &lt;/div&gt;
&lt;/ng-container&gt;

&lt;div class=&quot;order empty&quot;&gt;{{emptyMessage}}&lt;/div&gt;

</code></pre>
<p><strong>src/app/order/list.component.ts</strong></p>
<pre><code class="language-ts">import { Component, OnInit, Input } from '@angular/core';
import { Order, Item, OrderService } from '../order.service';


@Component({
  selector: 'pmo-order-list',
  templateUrl: './list.component.html',
  styleUrls: ['./list.component.less']
})
export class ListComponent implements OnInit {
  @Input() orders: [];
  @Input() listTitle: string;
  @Input() status: string;
  @Input() statusTitle: string;
  @Input() action: string;
  @Input() actionTitle: string;
  @Input() emptyMessage: string;
  isPending: boolean = false;

  constructor(private orderService: OrderService) { }

  ngOnInit() {}

  markAs(order: Order, action: string) {
    this.isPending = true;
    this.orderService.updateOrder(order, action).subscribe(() =&gt; {
      this.isPending = false;
    });
  }
  
  delete(id:string) {
    this.isPending = true;
    this.orderService.deleteOrder(id).subscribe(() =&gt; {
      this.isPending = false;
    })
  }

  total(items: Item[]) {
    let total = 0.0;
      items.forEach((item: Item) =&gt; {
        total += item.price;
      });
    return Math.round(total * 100) / 100;
  }
}

</code></pre>
<div line-highlight='6'></div>
<h2>Add Order History Route</h2>
<p><strong>src/app/app-routing.module.ts</strong></p>
<pre><code class="language-ts">import { NgModule } from '@angular/core';
import { Routes, RouterModule } from '@angular/router';

import { HomeComponent } from './home/home.component';
import { RestaurantComponent } from './restaurant/restaurant.component';
import { RestaurantDetailComponent } from './restaurant/detail/detail.component';
import { OrderComponent } from './order/order.component';
import { HistoryComponent } from './order/history/history.component';

const routes: Routes = [
  {
    path: '',
    component: HomeComponent,
  },
  {
    path: 'restaurants',
    component: RestaurantComponent,
  },
  {
    path: 'restaurants/:slug',
    component: RestaurantDetailComponent,
  },
  {
    path: 'restaurants/:slug/:order',
    component: OrderComponent,
  },
  {
    path: 'order-history',
    component: HistoryComponent
  }
];

@NgModule({
  imports: [RouterModule.forRoot(routes)],
  exports: [RouterModule]
})
export class AppRoutingModule { }

</code></pre>
<div line-highlight='8, 27-30'></div>
<h2>Adding Order History to Main Navigation</h2>
<p>Finally, let's add the order history path to the navigation.</p>
<p><strong>src/app/app.component.html</strong></p>
<pre><code class="language-html">&lt;header&gt;
  &lt;nav&gt;
   &lt;h1&gt;place-my-order.com&lt;/h1&gt;
   &lt;ul&gt;
     &lt;li routerLinkActive=&quot;active&quot; [routerLinkActiveOptions]=&quot;{exact: true}&quot;&gt;
       &lt;a routerLink=&quot;/&quot; &gt;Home&lt;/a&gt;
     &lt;/li&gt;
     &lt;li [ngClass]=&quot;{'active' : rla.isActive} &quot;&gt;
       &lt;a routerLink=&quot;/restaurants&quot; routerLinkActive #rla=&quot;routerLinkActive&quot;&gt;Restaurants&lt;/a&gt;
     &lt;/li&gt;
     &lt;li routerLinkActive=&quot;active&quot; [routerLinkActiveOptions]=&quot;{exact: true}&quot;&gt;
       &lt;a routerLink=&quot;/order-history&quot;&gt;Order History&lt;/a&gt;
     &lt;/li&gt;
   &lt;/ul&gt;
  &lt;/nav&gt;
&lt;/header&gt;
&lt;router-outlet&gt;&lt;/router-outlet&gt;

</code></pre>
<div line-highlight='11-13'></div>
<p>You should now be able to navigate to <a href="http://localhost:4200/order-history" target="_blank">http://localhost:4200/order-history</a>.</p>

</section>

			
		
	</article>
</div>

	<footer></footer>

	<script type="text/javascript">
		var docObject = {"src":{"path":"src/angular/15-order-history-component/order-history-component.md"},"description":"Writing the Order History Component ","name":"angular/order-history-component","title":"Order History Component","type":"page","parent":"angular","order":15,"comment":" ","pathToRoot":"../.."};
	</script>

	
		<script>
		  steal = {
		    instantiated: {
		      "bundles/bit-docs-site/static.css!$css" : null
		    }
		  }
		</script>
		<script type='text/javascript'
				data-main="bit-docs-site/static"
				src="../static/steal.production.js"></script>
	

<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-2302003-29"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-2302003-29');
</script>

</body>

</html>

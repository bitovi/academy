@page angular/building-our-first-app Building Our First App
@parent angular 2

@description Building our first app

@body

## Overview

In this part, we will:

- Install Angular's cli
- Generate a new app
- Look at the files generated by the cli
- Learn to serve our app

## Intro to the CLI

Angular has a CLI that does a lot of the initial legwork in setting up a minimal app. It also makes it really easy to create and include new components on the fly.

## Installation

We'll start by globally installing the Angular CLI using npm.

```shell
npm install -g @angular/cli@7
```

## Generating a new app

Our final goal is to build a restaurant menu and ordering application, which should look something like this:

![Place My Order App screenshot](../static/img/place-my-order.png "Place My Order App screenshot")

(reminder: You can see a DoneJS implementation of this application at [www.place-my-order.com](http://www.place-my-order.com))

To create a new Angular Workspace, we run the `ng new` command.

```shell
ng new place-my-order  --prefix pmo
cd place-my-order
```

This will create a new Angular Workspace, generate an app module, and set you up with any needed config files and a test suite for your new Angular project. To kick the process off you'll be asked a series of set-up questions by the CLI:
1. Would you like to add Angular routing? (__yes__)
2. Which stylesheet format would you like to use? (__Less__)

Note that we used the `--prefix` property above to set our own default prefix. Angular's default prefix is `app`, but a good naming convention is to use a short prefix related to your company or application name, which helps to easily differentiate from 3rd party utilities.

```html
//this looks like it's one of our own app components
<pmo-header></pmo-header>

//safe to assume this a 3rd party
<tabset>
  <tab heading="Basic title" id="tab1">Basic content</tab>
  <tab heading="Basic Title 1">Basic content 1</tab>
  <tab heading="Basic Title 2">Basic content 2</tab>
</tabset>

```

There are several more helpful properities that customize how a project is set up:

### --root

Specifies the main directory for all project files. Default empty.

### --sourceRoot

Directory for all project source files.

### --projectType

Allows you to specify if this is an application or a library.

### --targets

Used for customizing task commands (build, serve, test) from the default settings.

## Looking at Our Generated Workspace

Let's walk through some of the files that were generated.

```code
├── angular.json
├── package.json
├── package-lock.json
├── README.md
├── tsconfig.json
├── tslint.json
├── e2e/
├── src/
|   ├── index.html
|   ├── karma.conf.js
|   ├── main.ts
|   ├── polyfills.ts
|   ├── styles.less
|   ├── test.ts
|   ├── tsconfig.app.json
|   ├── tsconfig.spec.json
|   ├── tslint.json
|   ├── assets/
|   ├── environments/
|   |   ├── environment.ts
|   |   ├── environment.prod.ts
|   ├── app/
|   |   ├── app.module.ts
|   |   ├── app.component.ts
|   |   ├── app.component.spec.ts
|   |   ├── app.component.less
|   |   ├── app.component.html
|   |   ├── app-routing.module.ts
├── node_modules/
```

### angular.json

This file is the config schema for an Angular Workspace. By default Angular configures Webpack for it's build process, and uses the `angular.json` file to store the build information.

(Note, prior to Angular v6, this file was `.angular-cli.json`. When migrating versions, having the wrong workspace config file name is a common cause for problems.)

### tsconfig.json

This file contains our typescript compiling options.

### src/main.ts

This is the entry point of our application, it compiles and bootstraps our app.  

### src/index.html

This should feel familiar - our main index page.

```html
<!doctype html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <title>PlaceMyOrder</title>
        <base href="/">

        <meta name="viewport" content="width=device-width, initial-scale=1">
        <link rel="icon" type="image/x-icon" href="favicon.ico">
    </head>
    <body>
        //our entry component
        <pmo-root></pmo-root>
    </body>
</html>
```

### src/app/app.module.ts

This file is the root module for our app. Every Angular app has at least one module that determines how to compile and launch and app. It uses the @NgModule decorator with four properties:

- **declarations** `[array]`: where we include components, directives, and pipes that will be used by this module.
- **imports** `[array]`: where we include any other modules our app needs to use. This may include 3rd party modules like bootstrap datepickers, or modules we've created.
- **providers** `[array]`: where we include services that we want used at the global app level
- **bootstrap** `[array]`: where we include the root AppModule - this is the main Application view that hosts all of our other app views.

Further reading: <a href="https://angular.io/guide/architecture-services#dependency-injection-di" target="\_blank">Dependency Injection in Angular</a>

### src/app/app.component.ts

This is our root component, you saw it called in our index.html file as ``<app-root></app-root>``

## Serving Our App

```shell
npm run start
```

The `start` script command value is `ng serve` which starts a development server on port `4200` by default using <a href="https://github.com/webpack/webpack-dev-server" target="\_blank">webpack-dev-server</a>, and compiles a development version of the app. Any typescript errors will be caught by the compiler here, and once ready we can view our app at <a href="http://localhost:4200" target="\_blank">localhost:4200</a>. `ng serve` also has live-reload functionality, meaning the browser will automatically reload as changes are saved and compiled.

## Changing the markup

Let's change the markup to look like the home page of our place my order app.

__src/app/app.component.html__
```html
<h1>Place My Order App: Coming Soon!</h1>
<router-outlet></router-outlet>
```
@highlight 1-2

When you save your changes, you should see the new `h1` tag in your browser at  <a href="http://localhost:4200" target="\_blank">localhost:4200</a>.


## Running Tests

When we use the CLI to create modules, components, services, etc, it will automatically create spec files for each of them. 

To see the tests in action run `npm run test` in the command line. You should see one test failure. Open __src/app/app.component.spec.ts__ and update it so the test will pass with the changes we made to __src/app/app.component.html__

### Solution

The change we needed to make for our tests to pass is on the highlighted line 37.

We also included `schemas` metadata for our module. <a href="https://angular.io/api/core/NO_ERRORS_SCHEMA">NO_ERRORS_SCHEMA</a> will keep the compiler from throwing errors when unknown components are included in the tested components. 

In unit tests we often only want to test the very small piece of code we're work on and don't care about deeply nested components <a href="https://medium.com/@fivedicephoto/why-you-shouldnt-use-no-errors-schema-in-angular-unit-tests-cdd478c30782" target="\_blank">unless we're testing the props in a parent/child component relationship</a>. For our purposes in this training, it's safe to use here.  

@sourceref ./app.component.spec.ts
@highlight 37

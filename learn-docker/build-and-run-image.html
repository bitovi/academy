<!DOCTYPE html>
<!--####################################################################
	THIS IS A GENERATED FILE â€” ANY CHANGES MADE WILL BE OVERWRITTEN

	INSTEAD CHANGE:
	source: src/docker/4-build-and-run-image/build-and-run-image.md
	@page learn-docker/build-and-run-image
######################################################################## -->
<html lang="en">
<head>
  <! -- TEMP TEST COMMENT ðŸŽ‰ðŸŽ‰ðŸŽ‰ðŸŽ‰ðŸŽ‰ðŸŽ‰ðŸŽ‰ðŸŽ‰ðŸŽ‰ðŸŽ‰ðŸŽ‰ðŸŽ‰ðŸŽ‰ðŸŽ‰ðŸŽ‰ -->
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="google-site-verification" content="UMCgjrWAjJW_tHmYo6AerdZvVdmh8QHdY9Ywb59tpHw" />
  <meta name="description" content="Build an image and run a container for our Node.js app. 
">
  
  <!-- Google Tag Manager -->
  <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
  new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
  j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
  'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
  })(window,document,'script','dataLayer','GTM-P9MQVJS');</script>
  <!-- End Google Tag Manager -->

  <title>Bitovi Academy - Build and Run An Image</title>
  
  <link rel="stylesheet" type="text/css" href="../static/bundles/bit-docs-site/static.css">
  
</head>

<body>
  <!-- Google Tag Manager (noscript) -->
  <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-P9MQVJS"
  height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
  <!-- End Google Tag Manager (noscript) -->

  <div class="content">
	
		<div class="sidebar-left">
  
    
	<ul>
		
			
		
			
				
					<li class="
           						
           						">
						<a class="page"
							href="../learn-advanced-javascript.html"
							title="This course covers all the hard but important stuff you should know when learning JavaScript.">
							Advanced JavaScript
						</a>
						
					</li>
				
			
		
			
				
					<li class="
           						
           						">
						<a class="page"
							href="../learn-dom-jquery.html"
							title="Learn jQuery and the DOM APIs by building your own version of jQuery and using it to make a basic tabs widget. We strongly suggest finishing learn-advanced-javascript prior to starting this course.">
							DOM and jQuery
						</a>
						
					</li>
				
			
		
			
				
					<li class="
           						
           						">
						<a class="page"
							href="../learn-to-debug-javascript.html"
							title="This course covers the basics of JavaScript debugging.">
							Debug JavaScript
						</a>
						
					</li>
				
			
		
			
				
					<li class="
           						
           						">
						<a class="page"
							href="../learn-typescript.html"
							title="This course covers the basic essentials of TypeScript. At the end, you should be ready to develop projects in TypeScript.">
							Learn TypeScript
						</a>
						
					</li>
				
			
		
			
				
					<li class="
           						
           						">
						<a class="page"
							href="../learn-react-native.html"
							title="Learn React Native by building the feature-rich Place My Order application in this beginner React Native guide. This hands-on course will introduce you to fundamental React Native concepts! By the end of this course, you will have a strong understanding of JSX, function components, styling, state management, Hooks, data fetching, routing, and testing.">
							Learn React Native
						</a>
						
					</li>
				
			
		
			
		
			
				
					<li class="
           						
           						">
						<a class="page"
							href="../learn-web-components.html"
							title="">
							Learn Web Components
						</a>
						
					</li>
				
			
		
			
				
					<li class="
           						
           						">
						<a class="page"
							href="../learn-agile-program-management-with-jira.html"
							title="Learn how to build, maintain, and report on accurate multi-team plans with Jira.">
							Agile Program Management With Jira
						</a>
						
					</li>
				
			
		
			
				
					<li class="
           						
           						">
						<a class="page"
							href="../learn-rxjs.html"
							title="Learn RxJS by creating a validating credit card form.">
							Learn RxJS
						</a>
						
					</li>
				
			
		
			
				
					<li class="
           						
           						">
						<a class="page"
							href="../training.html"
							title="Learn how to prepare and give a training.">
							Giving a Training
						</a>
						
					</li>
				
			
		
			
				
					<li class="
           						
           						">
						<a class="page"
							href="../learn-technology-consulting.html"
							title="Learn how to move beyond writing code to be an excellent technology consultant!">
							Learn Technology Consulting
						</a>
						
					</li>
				
			
		
			
				
					<li class="
           						
           						">
						<a class="page"
							href="../learn-react.html"
							title="Learn React by building the feature-rich Place My Order application in this beginner React guide. This hands-on course will introduce you to fundamental React concepts! By the end of this course, you will have a strong understanding of JSX, function components, styling, state management, Hooks, data fetching, routing, and testing.">
							Learn React
						</a>
						
					</li>
				
			
		
			
				
					<li class="
           						
           						">
						<a class="page"
							href="../learn-ngrx.html"
							title="Learn how to manage state in an Angular application using NgRx.">
							Learn NgRx
						</a>
						
					</li>
				
			
		
			
				
					<li class="
           						
           						">
						<a class="page"
							href="../learn-graphql.html"
							title="Build a backend application for property rentals using Node JS, GraphQL and Apollo Server.         Learn about using ORMs like Mongoose and Prisma with a NoSQL Mongo database!
Write testcases testing created endpoints.">
							Learn Graphql
						</a>
						
					</li>
				
			
		
			
				
					<li class="
           						parent
           						expanded">
						<a class="page"
							href="../learn-docker.html"
							title="Build and containerize a Node.js app then orchestrate multiple containers with docker-compose in this Docker guide.">
							Learn Docker
						</a>
						
							
	<ul>
		
			
				
					<li class="
           						
           						">
						<a class="page"
							href="what-is-docker.html"
							title="Explore Docker concepts and architecture.">
							What is Docker
						</a>
						
					</li>
				
			
		
			
				
					<li class="
           						
           						">
						<a class="page"
							href="build-node-app.html"
							title="Build a simple Express API to use for the rest of the course.">
							Build a Node.js App
						</a>
						
					</li>
				
			
		
			
				
					<li class="
           						
           						">
						<a class="page"
							href="writing-a-dockerfile.html"
							title="Write a Dockerfile to containerize the Node.js app.">
							Writing a Dockerfile
						</a>
						
					</li>
				
			
		
			
				
					<li class="current
           						parent
           						expanded">
						<a class="page"
							href="build-and-run-image.html"
							title="Build an image and run a container for our Node.js app.">
							Build and Run An Image
						</a>
						
							

						
					</li>
				
			
		
			
				
					<li class="
           						
           						">
						<a class="page"
							href="volumes-and-local-development.html"
							title="Streamline local development with bind mounts.">
							Volumes and Local Development
						</a>
						
					</li>
				
			
		
			
				
					<li class="
           						
           						">
						<a class="page"
							href="production-readiness.html"
							title="Learn to reduce the size of docker images.">
							Production Readiness
						</a>
						
					</li>
				
			
		
			
				
					<li class="
           						
           						">
						<a class="page"
							href="docker-compose.html"
							title="Make Docker easier to use and orchestrate multiple containers.">
							Docker Compose
						</a>
						
					</li>
				
			
		
	</ul>


						
					</li>
				
			
		
			
				
					<li class="
           						
           						">
						<a class="page"
							href="../learn-canjs.html"
							title="This tutorial walks through building TodoMVC with StealJS. It includes KeyNote presentations
covering CanJS core libraries.">
							Learn CanJS
						</a>
						
					</li>
				
			
		
			
				
					<li class="
           						
           						">
						<a class="page"
							href="../learn-angular.html"
							title="Learn how to build a moderately complex application with Angular.">
							Learn Angular
						</a>
						
					</li>
				
			
		
			
				
					<li class="
           						
           						">
						<a class="page"
							href="../advanced-typescript.html"
							title="This is the second course in the TypeScript series. By the end, you will be comfortable with any types you come across and possess the knowledge to create your own advanced types. The only prerequisite is the first course in the TypeScript series found here.">
							Advanced TypeScript
						</a>
						
					</li>
				
			
		
	</ul>


  
  <p class="border">
      <a href="..#courses">View More Courses</a>
      <a class='bit-academy-fullscreen' title='fullscreen' href="javascript://">[ ]</a>
  </p>
</div>

	
	<article class="main">
    <div class="main-content">
  		
  			<section class="title">
	<h1>Build and Run An Image <code>page</code></h1>
</section>

  		

  		
  			
  				<section class="description">
    <p>Build an image and run a container for our Node.js app.</p>

</section>

  			
  		

  		
  			
  				
  			
  			
  				<section class="body">
    <iframe class="iframe-16-9" src="https://www.youtube.com/embed/sQ4TG6cfSfw" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
<h2 id="app-review">App Review</h2>
<p>In the last section, we created a <code>Dockerfile</code> for our Node.js app.</p>
<pre><code class="language-dockerfile">FROM node:15

ARG PORT=8000
ENV PORT=$PORT

WORKDIR app
COPY src src
COPY package.json .

RUN npm install
EXPOSE $PORT
CMD npm start
</code></pre>
<p>At this point, our directory should look like this</p>
<p><img alt="app directory" src="../static/img/docker/4-build-and-run-image/app-directory.png"></p>
<h2 id="build-our-image">Build our image</h2>
<p>Ensure you have docker desktop running on your machine, then open a terminal to your application directory and run</p>
<pre><code class="language-bash">docker build -t my-node-app .
</code></pre>
<ul>
<li>The <code>-t my-node-app</code> argument tells Docker to call the image produced by the <code>Dockerfile</code> &quot;my-node-app&quot; and tag it as &quot;latest&quot;. The &quot;latest&quot; tag is the default tag, but can be overridden when building an image with <code>:&lt;tagname&gt;</code>. For example, if we wanted to tag our image as <code>v1.0.0</code>, we would run <code>docker build -t my-node-app:v1.0.0 .</code>.</li>
<li>The <code>.</code> argument tells Docker where it can find our <code>Dockerfile</code>.</li>
</ul>
<p>Running the above command should produce output similar to below</p>
<pre><code class="language-bash">$ docker build -t my-node-app .
Sending build context to Docker daemon  4.608kB
Step 1/9 : FROM node:15
 ---&gt; b34e90f5c9c0
Step 2/9 : ARG PORT=8000
 ---&gt; Running in 10a283ade4d8
Removing intermediate container 10a283ade4d8
 ---&gt; dab34bb639a6
Step 3/9 : ENV PORT=$PORT
 ---&gt; Running in d59fa1f9c655
Removing intermediate container d59fa1f9c655
 ---&gt; 297c1df53ecf
Step 4/9 : WORKDIR app
 ---&gt; Running in 3c10f19e6c08
Removing intermediate container 3c10f19e6c08
 ---&gt; 939af75792da
Step 5/9 : COPY src src
 ---&gt; de93d743d3d2
Step 6/9 : COPY package.json .
 ---&gt; 8da01f3b7081
Step 7/9 : RUN npm install
 ---&gt; Running in f4dacf2d3094

added 168 packages, and audited 168 packages in 8s

10 packages are looking for funding
  run `npm fund` for details

found 0 vulnerabilities
Removing intermediate container f4dacf2d3094
 ---&gt; e791171147b9
Step 8/9 : EXPOSE $PORT
 ---&gt; Running in f8fc12376572
Removing intermediate container f8fc12376572
 ---&gt; a24bac3b5c39
Step 9/9 : CMD npm start
 ---&gt; Running in 50c5f19c7773
Removing intermediate container 50c5f19c7773
 ---&gt; 3eaf756066ae
Successfully built 3eaf756066ae
Successfully tagged my-node-app:latest
</code></pre>
<h2 id="view-our-image">View our image</h2>
<p>The <code>my-node-app:latest</code> image has been saved to our local Docker registry. Run <code>docker image ls</code> and you can see information about it.</p>
<pre><code class="language-bash">$ docker image ls
REPOSITORY          TAG                 IMAGE ID            CREATED             SIZE
my-node-app         latest              848464f1725a        5 seconds ago       944MB
node                15                  b34e90f5c9c0        24 hours ago        935MB
</code></pre>
<p>Youâ€™ll notice thereâ€™s also a <code>node:15</code> image in our registry. This is because we defined it as our base image in our <code>Dockerfile</code> (<code>FROM node:15</code>). It was pulled from Dockerhub so it can be used locally.</p>
<h2 id="run-our-image">Run our image</h2>
<p>Weâ€™re finally ready to run our image. Open a terminal and run</p>
<pre><code class="language-bash">docker run --name my-container -p 8000:8000 -d my-node-app:latest
</code></pre>
<ul>
<li><code>--name my-container</code> gives our container a friendly name. If this is not provided, Docker will name the container for you.</li>
<li><code>-p 8000:8000</code> publishes the containerâ€™s internal port 8000 to our host machineâ€™s port 8000. This will allow us to access the app from <code>localhost:8000</code></li>
<li><code>-d</code> runs the container in detached mode. This runs the process as a background process.</li>
<li><code>my-node-app:latest</code> specifies what image we want to run. If this image does not exist in our local registry, Docker will try and find and download a match from <a href="https://hub.docker.com/">Dockerhub</a>.</li>
</ul>
<p>Running the above command should produce output similar to below</p>
<pre><code class="language-bash">$ docker run --name my-container -p 8000:8000 -d my-node-app:latest
71cfe418a26a05bbebb160f541e53c025157dc7ee2c333ab2309c7bc66bb24e3
</code></pre>
<p>Open your browser to <code>localhost:8000</code> and you should see <code>Hello World!</code>. You just ran your first docker image!</p>
<h2 id="interacting-with-our-container">Interacting with our container</h2>
<p>Run <code>docker ps</code> to see the status of all running containers</p>
<pre><code class="language-bash">$ docker ps
CONTAINER ID        IMAGE                COMMAND                  CREATED              STATUS              PORTS                    NAMES
71cfe418a26a        my-node-app:latest   &quot;docker-entrypoint.sâ€¦&quot;   About a minute ago   Up About a minute   0.0.0.0:8000-&gt;8000/tcp   my-container
</code></pre>
<p>You can view logs with <code>docker logs &lt;container-name&gt;</code></p>
<pre><code class="language-bash">$ docker logs my-container

&gt; bitovi-academy-app@1.0.0 start
&gt; nodemon src/index.js

[nodemon] 2.0.6
[nodemon] to restart at any time, enter `rs`
[nodemon] watching path(s): *.*
[nodemon] watching extensions: js,mjs,json
[nodemon] starting `node src/index.js index.js`
Example app listening at http://localhost:8000
</code></pre>
<p>Finally, stop our container with <code>docker stop &lt;container-name&gt;</code> and <code>docker rm &lt;container-name&gt;</code>. If you want to do this with one command, just run <code>docker rm -f &lt;container-name&gt;</code>.</p>
<pre><code class="language-bash">$ docker rm -f my-container
my-container

$ docker ps
CONTAINER ID        IMAGE               COMMAND             CREATED             STATUS              PORTS               NAMES

</code></pre>
<h2 id="customize-the-port">Customize the port</h2>
<p>We can use the <code>-e</code> flag when starting our container to set the <code>PORT</code> environment variable.</p>
<pre><code class="language-bash">$ MY_PORT=9000
$ docker run --name my-container -p 8000:$MY_PORT -d -e PORT=$MY_PORT my-node-app:latest
0c0a51e7a19f37d503452892df9498de18c5dc78719aae2511b42a32f1f734ad

$ docker logs my-container

&gt; bitovi-academy-app@1.0.0 start
&gt; nodemon src/index.js

[nodemon] 2.0.6
[nodemon] to restart at any time, enter `rs`
[nodemon] watching path(s): *.*
[nodemon] watching extensions: js,mjs,json
[nodemon] starting `node src/index.js index.js`
Example app listening at http://localhost:9000
</code></pre>
<p>Youâ€™ll see the last line of the logs indicating the app is now listening on port 9000. However, because we set the port mapping with <code>-p 8000:9000</code>, we still will view the application in our browser from <code>localhost:8000</code>.</p>
<h2 id="review">Review</h2>
<p>Weâ€™ve built an image and run a container for our Node.js app. Hereâ€™s a cheat sheet of all the commands we ran.</p>
<pre><code class="language-bash"># Build an image
docker build -t my-node-app .

# Build an image with a custom tag
docker build -t my-node-app:v1.0.0 .

# List images in registry
docker image ls

# Create a container
docker run --name my-container -p 8000:$MY_PORT -d -e PORT=$MY_PORT my-node-app:latest

# List running containers
docker ps

# View container logs
docker logs &lt;container-name&gt;

# Kill a container
docker rm -f &lt;container-name&gt;
</code></pre>
<p>Next weâ€™ll look at introducing storage mounts to make local application development efficient.</p>

</section>

  			
  			<bit-prev-next class="footer" list-selector=".sidebar-left ul li.parent.expanded ul"></bit-prev-next>
  		
    </div>

    
      <div class="sidebar-right">
        <div class="content-nav on-this-page-container">
          <h6>On this page...</h6>
          <div class="list-items" id="scroll-toc">
            <bit-toc heading-container-selector="article.main" scroll-selector="#scroll-toc"></bit-toc>
          </div>
        </div>
        <div class="pullout discord">
          <h6>Get help</h6>
          <p>If you need <a href="https://discord.gg/J7ejFsZnJ4">help</a> with an exercise, please reach out to us on
             <a href="https://discord.gg/J7ejFsZnJ4">Discord</a></p>
        </div>
        <div class="pullout bug">
          <p>If you find a bug, please
             <a href="https://github.com/bitovi/academy/issues/new">create an issue</a> or email
             <a href="mailto:contact@bitovi.com?Subject=Training%20Suggestion" target="_blank">contact@bitovi.com</a></p>
        </div>
      </div>
    

	</article>
</div>


  <div id="scripts">
    <script type="text/javascript">
      var docObject = {"src":{"path":"src/docker/4-build-and-run-image/build-and-run-image.md"},"description":"Build an image and run a container for our Node.js app. \n","name":"learn-docker/build-and-run-image","title":"Build and Run An Image","type":"page","parent":"learn-docker","order":4,"comment":" ","pathToRoot":"../.."};
    </script>

    
      <script>
        steal = {
          instantiated: {
            "bundles/bit-docs-site/static.css!$css" : null
          }
        }
      </script>
      <script type='text/javascript'
          data-main="bit-docs-site/static"
          src="../static/steal.production.js"></script>
    

  </div>
  <div id="email-modal" role="dialog" aria-modal="true" aria-labelledby="dialog_label" style="display: none;">
    <div aria-hidden="true" class="email-modal-backdrop"></div>
    <div role="region" class="email-modal-content">
      <h2 id="dialog_label">Join the Bitovi Newsletter</h2>
      <p>
        Do you want to receive updates about new Bitovi Academy courses, Bitovi open source projects, and dev community news? If so, please provide your email. We wonâ€™t spam you or give it away for any reason!<br />
        <i style="font-size: 0.8rem;">By providing your email you agree to receive communications from Bitovi</i>
      </p>
      <div id="academy-hubspot-form-embed"></div>
      <script charset="utf-8" type="text/javascript" src="//js.hsforms.net/forms/embed/v2.js"></script>
      <button id="email-modal-close" title="dismiss"><img src="../static/img/close.svg" height="24" width="24"></button>
    </div>
  </div>
</body>
</html>
